{% load staticfiles %}
{% load django_tables2 %}
<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="{% static 'water/style.css' %}" />
    <link rel="icon" type="image/jpg" href="{% static "water/favicon.ico" %}" /> 
    <title>MARS Home</title>
    <style>
      .prod {
      background-color: rgba(255,255,0,0.3);
      }
      .ops {
      background-color: rgba(0,255,0,0.3);
      }
      .dev {
      background-color: rgba(255,0,0,0.3);
      }
      .test {
      background-color: rgba(0,0,255,0.1);
      }
      .inactive {
      background-color: rgba(0,0,0,0.2);
      }
</style>
</head>
<body>
  <h3><a href="http://marsmobile.jpl.nasa.gov/multimedia/resources/mars-posters-explorers-wanted/?linkId=25534068">
      <img src="{% static 'water/favicon.ico' %}" alt="">
    </a>
    MARS: Metadata Archive Retrival Services
({{ mars_updated }}, v{{ mars_version }})
    using DB-Host "{{ dbhost }}"    
  </h3>

  <p>
    Here are some of the MARS apps.
    <em>
      Very few of these are used during production TADA processing.
      See the legend at the bottom of the page.
    </em>
  </p>

  <table>
    <tr class="inactive">
      <th>Example URI</th>
      <th>Description</th>
    </tr>

    <!-- #################################################################### -->
    <!-- ### Admin                       -->
    <!-- ###                             -->
    <!--
    <tr class="ops">
      <th><a href="{% url 'admin:index' %}">/admin/</a></th>
      <td>Change MARS data (not FITS data or Archive metadata).</td>
    </tr>
    -->
    <tr class="ops">
      <th>
        <a href="{% url 'admin:audit_auditrecord_changelist' %}">
          {% url 'admin:audit_auditrecord_changelist' %}        
        </a>
      </th>
      <td>Audit records.  Filter (and change) them.</td>
    </tr>
    <!--
    <tr>
      <th>
	<a href="{% url 'admin:index' %}provisional/fitsname/add/">
	  /admin/provisional/fitsname/add/
      </a></th>
      <td>Record FITS file as provisional.</td>
    </tr>
    -->
    <tr class="ops">
      <th>
	<a href="{% url 'admin:index' %}schedule/slot/">
	  /admin/schedule/slot/
	</a>
      </th>
      <td>Edit schedule.</td>
    </tr>
    <tr class="ops">
      <th>
	<a href="{% url 'admin:index' %}tada/">
	  /admin/tada/
	</a>
      </th>
      <td>Edit data affecting TADA behavior.</td>
    </tr>

    <tr class="dev">
      <th><a href="{% url 'admin:index' %}doc/">/admin/doc/</a></th>
      <td>Documentation (for developers) automatically generated from
	docstrings of code.  Includes: template
	tags, template filters, models, views, bookmarklets
      </td>
    </tr>
    
    <!-- ################################################################### -->
    <!-- ### TADA                       -->
    <!-- ###                             -->
    <tr class="ops">
      <th>
	    <a href="{% url 'tada:prefix' %}">
	      {% url 'tada:prefix' %}
	    </a>
      </th>
      <td>
	    Return table mapping Site,Telescope,Instrument to filename prefix.
      </td>
    </tr>
    <tr class="ops">
      <th>
	    <a href="{% url 'tada:obstype' %}">
	      {% url 'tada:obstype' %}
	    </a>
      </th>
      <td>
	    Return Observation type table.
      </td>
    </tr>
    <tr class="ops">
      <th>
	    <a href="{% url 'tada:proctype' %}">
	      {% url 'tada:proctype' %}
	    </a>
      </th>
      <td>
	    Return Processing type table.
      </td>
    </tr>
    <tr class="ops">
      <th>
	    <a href="{% url 'tada:prodtype' %}">
	      {% url 'tada:prodtype' %}
	    </a>
      </th>
      <td>
	    Return Product type table.
      </td>
    </tr>
    <tr class="ops">
      <th>
	    <a href="{% url 'tada:rawreq' %}">
	      {% url 'tada:rawreq' %}
	    </a>
      </th>
      <td>
	    Return Raw keywords table.
      </td>
    </tr>
    <tr class="ops">
      <th>
	    <a href="{% url 'tada:filenamereq' %}">
	      {% url 'tada:filenamereq' %}
	    </a>
      </th>
      <td>
	    Return Filename keywords table.
      </td>
    </tr>
    <tr class="ops">
      <th>
	    <a href="{% url 'tada:ingestreq' %}">
	      {% url 'tada:ingestreq' %}
	    </a>
      </th>
      <td>
	    Return Ingest keywords table.
      </td>
    </tr>
    <tr class="ops">
      <th>
	    <a href="{% url 'tada:ingestrec' %}">
	      {% url 'tada:ingestrec' %}
	    </a>
      </th>
      <td>
	    Return Ingest Recommended keywords table.
      </td>
    </tr>
    <tr class="ops">
      <th>
	    <a href="{% url 'tada:supportreq' %}">
	      {% url 'tada:supportreq' %}
	    </a>
      </th>
      <td>
	    Return keywords used in hdr_cacl_funcs table.
      </td>
    </tr>
    <tr class="ops">
      <th>
	    <a href="{% url 'tada:floatreq' %}">
	      {% url 'tada:floatreq' %}
	    </a>
      </th>
      <td>
	    Return keywords that will be scrubbed to float values (or error).
      </td>
    </tr>


    <!-- ################################################################### -->
    <!-- ### Schedule                    -->
    <!-- ###                             -->

    <!--
    <tr>
      <th><a href="{% url 'schedule:list' %}">{% url 'schedule:list' %}</a></th>
      <td>List the schedule.</td>
    </tr>
    <tr>
      <th>/schedule/scrape/BEGIN_YYYYMMDD/END_YYYYMMDD/</th>
      <th>Load schedule for range of dates.</th>
    </tr>
    <tr class="ops">
      <th>
	<a href="{% url 'schedule:list_empty' %}">
	  {% url 'schedule:list_empty' %}
	</a>
      </th>
      <td>List slots that have been queried but didn't contain
      anything. </td>
    </tr>
    -->
    <tr class="ops">
      <th>
	    <a href="{% url 'schedule:setpropid' 'kp4m' 'kosmos' '2016-02-01' 'Mine' %}">
	      {% url 'schedule:setpropid' 'kp4m' 'kosmos' '2016-02-01' 'Mine' %}
	    </a>
      </th>
      <td>
	    Set propid given telescope, instrument, observation date.
      </td>
    </tr>
    <tr class="prod">
      <th>
	    <a href="{% url 'schedule:getpropid' 'kp4m' 'kosmos' '2016-02-01' %}">
	      {% url 'schedule:getpropid' 'kp4m' 'kosmos' '2016-02-01' %}
	    </a>
      </th>
      <td>
	    Get propid given telescope, instrument, observation date.
	    <i>(2015B-0313)</i>
      </td>
    </tr>
    <!--
    <tr>
      <th>
	<a href="{% url 'schedule:month_list' '2015' 'aug' %}">
	  {% url 'schedule:month_list' '2015' 'aug' %}
	</a>
      </th>
      <td>Get a months worth.</td>
    </tr>
    {% comment %}
    <tr>
      <th><a href="{% url 'schedule:week_list' '2015' '23' %}">/schedule/2015/week/23/</a></th>
      <td>Get a weeks worth.</td>
    </tr>
    <tr>
      <th>
	<a href="{% url 'schedule:day_list' '2015' 'aug' '23' %}">
	  {% url 'schedule:day_list' '2015' 'aug' '23' %}
	</a>
      </th>
      <td>Get a days worth.</td>
    </tr>
    {% endcomment %}
    <tr>
      <th>
	<a href="{% url 'schedule:today_list' %}">
	  {% url 'schedule:today_list' %}
	</a>
      </th>
      <td>Get todays schedule.</td>
    </tr>
    <tr>
      <th>
	<a href="{% url 'schedule:upload_file' %}">
	  {% url 'schedule:upload_file' %}
	</a>
      </th>
      <td>Upload XML file of schedule data and load it.</td>
    </tr>
    -->
    <tr class="prod">
      <th>
	<a href="{% url 'schedule:update_date' '2015-09-04' %}">
	  {% url 'schedule:update_date' '2015-09-04' %}
	</a>
      </th>
      <td>
	Update DMO telescope DATE (all telescopes) schedule using
	www.noao.edu./noaoprop service.
	<i><b>
	    If a "schedule/update" service is not done after each
	    update to the TAC schedule, files may be ingested with the
	    wrong Propid!
	</b></i>
      </td>
    </tr>
    <tr class="prod">
      <th>
	<a href="{% url 'schedule:update_semester' '2015B'%}">
	  {% url 'schedule:update_semester' '2015B'%}
	</a>
      </th>
      <td>
	Update DMO telescope SEMESTER schedule using
	TAC service at www.noao.edu./noaoprop.
	<b>Will take several minutes!</b>
	<i><b>
	    If a "schedule/update" service is not done after each
	    update to the TAC schedule, files may be ingested with the
	    wrong Propid!
	  </b></i>
      </td>
    </tr>
    <tr class="dev">
      <th>
        <a href="http://www.noao.edu/noaoprop/schedule.mpl?semester=2015B">
          http://www.noao.edu/noaoprop/schedule.mpl?semester=2015B
        </a>
      </th>
      <td>
	A semester of the schedule from Dave Bell's DB. aka:
	<i>"The TAC schedule"</i>
      </td>
    </tr>

    <!-- ################################################################### -->
    <!-- ### SIAP querying               -->
    <!-- ###                             -->

    <!--
    <tr>
      <th><a href="{% url 'siap:index' %}">/siap/</a></th>
      <td>SIAP index of all files.</td>
    </tr>
    -->
    <tr  class="test">
      <th><a href="{% url 'siap:query_by_url' %}{% querystring 'min:date_obs'='05-28-2016' 'reference'='c13a' %}">
	  {% url 'siap:query_by_url' %}{% querystring 'min:date_obs'='05-28-2016' 'reference'='c13a' %}
      </a></th>
      <td>
	Query SIAP using URL query string. If "reference" column,
	it is matched as a substring.  All others use exact match.
	<br />
	CSV and JSON return values are possible using CURL.  Examples:
	<br />
	<pre>
  curl -H "Content-Type: text/csv" 'http://localhost:8000/siap/query/?limit=10'
  curl -H "Content-Type: text/csv" \
     'http://localhost:8000/siap/query/?limit=10&columns=path'
  curl -H "Content-Type: text/csv" \
     'http://localhost:8000/siap/query/?limit=10&columns=reference,dtpropid'

  curl -H "Content-Type: application/json" \
    'http://localhost:8000/siap/query/?limit=10&date_obs=02-28-2006&reference=k21i' \
    > foo.json
	</pre>
      </td>
    </tr>
    <tr class="inactive">
      <th><a href="/siap/fquery?cols=reference&limit=2">
	  /siap/fquery?cols=reference&limit=2
      </a></th>
      <td>Query voi.siap using form or URL parameter. Direct query using a string payload
	is available via: {% url 'siap:query_by_sql' %}
      </td>
    </tr>
    <tr class="test">
      <th>{% url 'siap:query_by_sql' %}</th>
      <td>Query voi.siap using SQL string.
        SQL must be of format:
        <i>SELECT {field}[,{field}...] FROM voi.siap {something};</i>
	    <br />
	    <br />
        For <b>SQL in file</b> use something like: <br />
	    <i>curl --data-binary @sql/files20.sql http://localhost:8000/siap/squery</i>
	    <br />
	    <br />For <b>SQL in string</b> use something like: <br />
	    <i>curl --data-binary "select reference,dtacqnam from voi.siap limit 5" http://localhost:8000/siap/squery </i>
      </td>
    </tr>

    <tr class="dev">
      <th><a href="{% url 'siap:tada' %}">/siap/tada/</a></th>
      <td>List of all Archive files containing substring "TADA". Get
      different renderings based on requested content type. Examples:
      <pre>
  curl -H "Content-type: application/json" 'http://localhost:8000/siap/tada/'
  curl -H "Content-type: text/csv" 'http://localhost:8000/siap/tada/' >x.csv
      </pre>
      </td>
    </tr>
    <!-- subsumed by /siap/query/?dtpropid=2011A-0525
    <tr>
      <th>
        <a href="{% url 'siap:filenames' '2011A-0525' %}">
	  {% url 'siap:filenames' '2011A-0525' %}
	  (<i>/siap/prop/PROPID</i>)
	</a>
      </th>
      <td>Filenames associated with PROPID='2011A-0525'</td>
    </tr>
    -->


    <!-- ################################################################### -->
    <!-- ### Audit                       -->
    <!-- ###                             -->
    <tr class="prod">
      <th>
	    {% url 'audit:update_fstop' '1900c5e4e342f293d538507dfd2bff3a' 'valley:cache' 'valley.sdm' %}
      </th>
      <td>
	    Record location (tag) of file in its journey from Dome to
	    Archive.
	    <form method="POST">
	      MD5SUM: <input type="text" name="md5sum"/>
	      fstop: <input type="text" name="fstop" size="7"/>
	      host: <input type="text" name="host" size="7"/>
	      <input type="submit" value="Submit"/>
	    </form>
      </td>
    </tr>
    
    
    <tr class="ops">
      <th>
	    <a href="{% url 'audit:agg' %}">
	      {% url 'audit:agg' %}
	    </a>
      </th>
      <td>
	    For <b>monitoring progress</b> of ingestion. Similar to Sean's
	    <a href="http://docs.sdm.noao.edu/checknight/">CheckNight</a>
      </td>
    </tr>
    <!--
    <tr class="ops">
      <th>
	    <a href="{% url 'audit:sourcefile_list' %}">
	      {% url 'audit:sourcefile_list' %}
	    </a>
      </th>
      <td>
	    For <b>monitoring progress</b> pf ingestion.  List audit records. 
      </td>
    </tr>
    -->

    
    
    <!-- #################################################################### -->
    <!-- ### Provisional                 -->
    <!-- ###                             -->

    <tr class="test">
      <th><a href="{% url 'provisional:index' %}">/provisional/</a></th>

      <td>List of all files stored in the Archive on a provisional basis.
        These can be deleted as a batch or individiually through
        web-services.</td>
    </tr>
    <tr class="test">
      <th>
	<a href="{% url 'provisional:stuff' %}">
	  {% url 'provisional:stuff' %}
	</a>
      </th>
      <td>Insert all files matching "TADA like" reference file into
        provisional list.</td>
    </tr>
    <tr  class="test">
      <th>/provisional/delete/REF_FILENAME/</th>
      <td><strong>Delete a file from Archive</strong> and the
        provisional list.</td>
    </tr>
    <tr class="test">
      <th>
	<a href="{% url 'provisional:rollback' %}">
	  {% url 'provisional:rollback' %}
	</a>
      </th>
      <td>
	<strong>Delete all files that are in provisional list from Archive
	</strong>
	and from the provisional list.
      </td>
    </tr>
    <tr class="test">
      <th>
        <a href="{% url 'provisional:index'%}add/ksb_150709_044421_ori_TADATEST.fits.fz/?source=my-bok-999.fits">
          /provisional/add/{ref_filename}/?source={source_filename}
        </a>
      </th>
      <td>
        Add a file to list of provisional files. Overwrites previous
        REF_FILENAME if it exists.
        can use as in:
        <pre>
  fname=/data/scraped/mtn_raw/ct15m-echelle/chi141225.1273.fits
  curl "http://localhost:8000/provisional/add/ref5/?source=$fname"
        </pre>
      </td>
    </tr>

    <!-- ################################################################### -->
    <!-- ### Other                       -->
    <!-- ###                             -->
    
    <tr  class="inactive">
      <th><a href="docs">/docs/</a></th>
      <td>
	Web-service API automatically generated documentation.
      </td>
    </tr>
    <tr  class="inactive">
      <th><a href="api">/api/</a></th>
      <td>Django REST framework auto generated API pages</td>
    </tr>
  </table>

  <br />

  <table id="legend">
    <caption><b>Legend</b></caption>
    <tr class="prod">
      <th><em>Production:</em></th>
      <td>Intended for use in production environent.</td>
    </tr>
    <tr class="ops">
      <th><em>Operations:</em></th>
      <td>possibly used by DMO staff</td>
    </tr>
    <tr class="dev">
      <th><em>Deveolpment:</em></th>
      <td>info on interfacing to services via software</td>
    </tr>
    <tr class="test">
      <th><em>Testing:</em></th>
      <td>used by smoke tests, etc.</td>
    </tr>
    <tr class="inactive">
      <th><em>Inactive:</em></th>
      <td>Inactive or under construction</td>
    </tr>
  </table>
  <p>
    The types given in the legend are also used to distinquish
    different sets of MARS unit tests.  So, for instance, one can test
    all the "Production" related web-services without testing
    "Development" related ones.  Generally, more and better unit
    testing is done for types at the top of the legend. Types at the
    bottom may have no unit testing done at all.
  </p>

  
</body>
</html>
